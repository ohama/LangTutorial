# Requirements Archive: v2.0 실용성 강화

**Archived:** 2026-02-01
**Status:** SHIPPED

This is the archived requirements specification for v2.0.
For current requirements, see `.planning/REQUIREMENTS.md` (created for next milestone).

---

# v2.0 Requirements: 실용성 강화

**Milestone:** FunLang v2.0
**Goal:** 코드 문서화, 문자열 타입, 대화형 개발 환경 추가
**Research:** `.planning/research/v2.0/SUMMARY.md`

---

## Overview

v2.0은 v1.0의 Turing-complete 언어에 실용적인 기능을 추가합니다:
1. **주석** - 코드 문서화
2. **문자열** - 새로운 데이터 타입
3. **REPL** - 대화형 개발 환경

---

## Phase 1: Comments (주석) - COMPLETE

### Requirements

| ID | Requirement | Priority | Status | Acceptance Criteria |
|----|-------------|----------|--------|---------------------|
| CMT-01 | 단일행 주석 `//` | MUST | [x] SHIPPED | `// comment` 이후 줄 끝까지 무시 |
| CMT-02 | 다중행 주석 `(* *)` | SHOULD | [x] SHIPPED | `(* ... *)` 사이 모든 내용 무시 |
| CMT-03 | 중첩 주석 지원 | SHOULD | [x] SHIPPED | `(* outer (* inner *) outer *)` 올바르게 파싱 |
| CMT-04 | 미종료 주석 오류 | MUST | [x] SHIPPED | `(* without close` → 명확한 오류 메시지 |

### Implementation Notes

- Lexer-only 변경 (Parser, AST, Eval 변경 없음)
- `/` 연산자보다 `//` 패턴이 먼저 매칭됨
- 다중행 주석은 fslex `and` 규칙으로 depth 추적

---

## Phase 2: Strings (문자열) - COMPLETE

### Requirements

| ID | Requirement | Priority | Status | Acceptance Criteria |
|----|-------------|----------|--------|---------------------|
| STR-01 | 문자열 리터럴 | MUST | [x] SHIPPED | `"hello"` → StringValue "hello" |
| STR-02 | 이스케이프: `\\` | MUST | [x] SHIPPED | `"\\"` → 백슬래시 문자 |
| STR-03 | 이스케이프: `\"` | MUST | [x] SHIPPED | `"\""` → 큰따옴표 문자 |
| STR-04 | 이스케이프: `\n` | MUST | [x] SHIPPED | `"\n"` → 개행 문자 |
| STR-05 | 이스케이프: `\t` | MUST | [x] SHIPPED | `"\t"` → 탭 문자 |
| STR-06 | 문자열 연결 | MUST | [x] SHIPPED | `"a" + "b"` → `"ab"` |
| STR-07 | 문자열 동등 비교 | MUST | [x] SHIPPED | `"a" = "a"` → true |
| STR-08 | 문자열 부등 비교 | MUST | [x] SHIPPED | `"a" <> "b"` → true |
| STR-09 | 빈 문자열 | MUST | [x] SHIPPED | `""` → StringValue "" |
| STR-10 | 미종료 문자열 오류 | MUST | [x] SHIPPED | `"unclosed` → 명확한 오류 |
| STR-11 | 문자열 내 개행 금지 | MUST | [x] SHIPPED | 리터럴 개행 → 오류 |
| STR-12 | 혼합 타입 연산 오류 | MUST | [x] SHIPPED | `"a" + 1` → 타입 오류 |

### Implementation Notes

- **Lexer**: STRING 토큰, `and read_string` 상태 머신
- **Parser**: STRING 토큰 → String AST 노드
- **AST**: `String of string` 추가, `StringValue of string` 추가
- **Eval**: Add/Equal/NotEqual 패턴 확장
- **Format**: StringValue → `"quoted"` 형식 출력

---

## Phase 3: REPL (대화형 셸) - COMPLETE

### Requirements

| ID | Requirement | Priority | Status | Acceptance Criteria |
|----|-------------|----------|--------|---------------------|
| REPL-01 | 기본 루프 | MUST | [x] SHIPPED | 프롬프트 표시, 입력 읽기, 평가, 결과 출력 |
| REPL-02 | 프롬프트 | MUST | [x] SHIPPED | `funlang> ` 프롬프트 표시 |
| REPL-03 | 환경 지속성 | MUST | [x] SHIPPED | let 바인딩이 다음 입력에서도 유효 |
| REPL-04 | 오류 복구 | MUST | [x] SHIPPED | 오류 발생 시 루프 계속 |
| REPL-05 | EOF 종료 | MUST | [x] SHIPPED | Ctrl+D (EOF) 시 정상 종료 |
| REPL-06 | #quit 명령 | MUST | [x] SHIPPED | `#quit` 입력 시 정상 종료 |
| REPL-07 | CLI 플래그 | SHOULD | [x] SHIPPED | `--repl` 또는 인자 없이 실행 |
| REPL-08 | 시작 메시지 | SHOULD | [x] SHIPPED | 버전, 종료 방법 안내 |

### Implementation Notes

- **Cli.fs**: Argu DU 기반 CLI 인자 타입
- **Repl.fs**: 재귀 함수 기반 REPL 루프
- **Program.fs**: Argu 파서로 리팩토링
- REPL-03: 현재 let-in 방식으로 환경 스레딩 (영구 바인딩은 미래 확장)
- REPL-06: `exit` → `#quit`으로 변경 (F# Interactive 관례)

---

## Non-Goals (v2.1+로 연기)

| Feature | Reason |
|---------|--------|
| REPL 히스토리 (↑/↓) | 외부 라이브러리 필요 |
| Tab 자동완성 | 복잡도 높음 |
| 문자열 인덱싱 `s.[0]` | 새 구문 필요 |
| 문자열 함수 `length` | 내장 함수 메커니즘 필요 |
| 문자열 보간 `$"{x}"` | 파싱 복잡도 높음 |
| 다중행 REPL 입력 | 완료 감지 복잡 |

---

## Test Coverage

### Comments Phase
- `//` 단일행 주석 (3 tests)
- `(* *)` 다중행 주석 (3 tests)
- 중첩 주석 (2 tests)
- 오류 케이스 (2 tests)
- Non-interference (2 tests)

### Strings Phase
- 리터럴 파싱 (3 tests)
- 이스케이프 시퀀스 (5 tests)
- 연산 (4 tests)
- 타입 오류 (3 tests)

### REPL Phase
- 기본 평가 (2 tests)
- 환경 지속성 (3 tests)
- 오류 복구 (2 tests)
- 종료 (2 tests)

---

## Milestone Summary

**Shipped:** 24 of 24 requirements (100%)
**Adjusted:** REPL-06 changed from `exit` to `#quit` (user request)
**Dropped:** None

---
*Archived: 2026-02-01 as part of v2.0 milestone completion*
